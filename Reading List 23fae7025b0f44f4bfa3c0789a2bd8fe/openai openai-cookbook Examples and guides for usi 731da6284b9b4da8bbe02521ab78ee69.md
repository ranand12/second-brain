# openai/openai-cookbook: Examples and guides for using the OpenAI API

Column: https://github.com/openai/openai-cookbook
Processed: No
created on: April 10, 2023 6:51 AM
topics: openai, tech-stuff

[openai-cookbook](openai%20openai-cookbook%20Examples%20and%20guides%20for%20usi%20731da6284b9b4da8bbe02521ab78ee69/openai-cookbook)

# OpenAI Cookbook

The OpenAI Cookbook shares example code for accomplishing common tasks with the [OpenAI API](https://openai.com/api/).

To run these examples, you'll need an OpenAI account and associated API key ([create a free account](https://beta.openai.com/signup)).

Most code examples are written in Python, though the concepts can be applied in any language.

## Recently added

![](openai%20openai-cookbook%20Examples%20and%20guides%20for%20usi%20731da6284b9b4da8bbe02521ab78ee69/1f195.png)

![](openai%20openai-cookbook%20Examples%20and%20guides%20for%20usi%20731da6284b9b4da8bbe02521ab78ee69/2728.png)

- [How to format inputs to ChatGPT models](https://github.com/openai/openai-cookbook/blob/main/examples/How_to_format_inputs_to_ChatGPT_models.ipynb) [Mar 1st, 2023]
- [Using Vector Databases for Embeddings Search with Redis](https://github.com/openai/openai-cookbook/tree/main/examples/vector_databases/redis) [Feb 15th, 2023]
- [Website Q&A with Embeddings](https://github.com/openai/openai-cookbook/tree/main/apps/web-crawl-q-and-a) [Feb 11th, 2023]
- [File Q&A with Embeddings](https://github.com/openai/openai-cookbook/tree/main/apps/file-q-and-a) [Feb 11th, 2023]
- [Visualize Embeddings in Weights & Biases](https://github.com/openai/openai-cookbook/blob/main/examples/Visualizing_embeddings_in_W%26B.ipynb) [Feb 9th, 2023]
- [Retrieval Enhanced Generative Question Answering with Pinecone](https://github.com/openai/openai-cookbook/blob/main/examples/vector_databases/pinecone/Gen_QA.ipynb) [Feb 8th, 2023]

## Guides & examples

- API usage
    - [How to handle rate limits](https://github.com/openai/openai-cookbook/blob/main/examples/How_to_handle_rate_limits.ipynb)
        - [Example parallel processing script that avoids hitting rate limits](https://github.com/openai/openai-cookbook/blob/main/examples/api_request_parallel_processor.py)
    - [How to count tokens with tiktoken](https://github.com/openai/openai-cookbook/blob/main/examples/How_to_count_tokens_with_tiktoken.ipynb)
    - [How to stream completions](https://github.com/openai/openai-cookbook/blob/main/examples/How_to_stream_completions.ipynb)
- ChatGPT
    - [How to format inputs to ChatGPT models](https://github.com/openai/openai-cookbook/blob/main/examples/How_to_format_inputs_to_ChatGPT_models.ipynb)
- GPT-3
    - [Guide: How to work with large language models](https://github.com/openai/openai-cookbook/blob/main/how_to_work_with_large_language_models.md)
    - [Guide: Techniques to improve reliability](https://github.com/openai/openai-cookbook/blob/main/techniques_to_improve_reliability.md)
    - [How to use a multi-step prompt to write unit tests](https://github.com/openai/openai-cookbook/blob/main/examples/Unit_test_writing_using_a_multi-step_prompt.ipynb)
    - [Text writing examples](https://github.com/openai/openai-cookbook/blob/main/text_writing_examples.md)
    - [Text explanation examples](https://github.com/openai/openai-cookbook/blob/main/text_explanation_examples.md)
    - [Text editing examples](https://github.com/openai/openai-cookbook/blob/main/text_editing_examples.md)
    - [Code writing examples](https://github.com/openai/openai-cookbook/blob/main/code_writing_examples.md)
    - [Code explanation examples](https://github.com/openai/openai-cookbook/blob/main/code_explanation_examples.md)
    - [Code editing examples](https://github.com/openai/openai-cookbook/blob/main/code_editing_examples.md)
- Embeddings
    - [Text comparison examples](https://github.com/openai/openai-cookbook/blob/main/text_comparison_examples.md)
    - [How to get embeddings](https://github.com/openai/openai-cookbook/blob/main/examples/Get_embeddings.ipynb)
    - [Question answering using embeddings](https://github.com/openai/openai-cookbook/blob/main/examples/Question_answering_using_embeddings.ipynb)
    - [Semantic search using embeddings](https://github.com/openai/openai-cookbook/blob/main/examples/Semantic_text_search_using_embeddings.ipynb)
    - [Recommendations using embeddings](https://github.com/openai/openai-cookbook/blob/main/examples/Recommendation_using_embeddings.ipynb)
    - [Clustering embeddings](https://github.com/openai/openai-cookbook/blob/main/examples/Clustering.ipynb)
    - [Visualizing embeddings in 2D](https://github.com/openai/openai-cookbook/blob/main/examples/Visualizing_embeddings_in_2D.ipynb) or [3D](https://github.com/openai/openai-cookbook/blob/main/examples/Visualizing_embeddings_in_3D.ipynb)
    - [Embedding long texts](https://github.com/openai/openai-cookbook/blob/main/examples/Embedding_long_inputs.ipynb)
- Fine-tuning GPT-3
    - [Guide: best practices for fine-tuning GPT-3 to classify text](https://docs.google.com/document/d/1rqj7dkuvl7Byd5KQPUJRxc19BJt8wo0yHNwK84KfU3Q/edit)
    - [Fine-tuned classification](https://github.com/openai/openai-cookbook/blob/main/examples/Fine-tuned_classification.ipynb)
- DALL-E
    - [How to generate and edit images with DALL-E](https://github.com/openai/openai-cookbook/blob/main/examples/dalle/Image_generations_edits_and_variations_with_DALL-E.ipynb)
- Azure OpenAI (alternative API from Microsoft Azure)
    - [How to get completions from Azure OpenAI](https://github.com/openai/openai-cookbook/blob/main/examples/azure/completions.ipynb)
    - [How to get embeddings from Azure OpenAI](https://github.com/openai/openai-cookbook/blob/main/examples/azure/embeddings.ipynb)
    - [How to fine-tune GPT-3 with Azure OpenAI](https://github.com/openai/openai-cookbook/blob/main/examples/azure/finetuning.ipynb)
- Apps
    - [File Q and A](https://github.com/openai/openai-cookbook/blob/main/apps/file-q-and-a)
    - [Web Crawl Q and A](https://github.com/openai/openai-cookbook/blob/main/apps/web-crawl-q-and-a)

## Related resources

Beyond the code examples here, you can learn about the [OpenAI API](https://openai.com/api/) from the following resources:

- Try out the API in the [OpenAI Playground](https://beta.openai.com/playground)
- Read about the API in the [OpenAI Documentation](https://beta.openai.com/docs/introduction)
- Discuss the API in the [OpenAI Community Forum](https://community.openai.com/top?period=monthly)
- Look for help in the [OpenAI Help Center](https://help.openai.com/en/)
- See example prompts in the [OpenAI Examples](https://beta.openai.com/examples)
- Play with a free research preview of [ChatGPT](https://chat.openai.com/)
- Stay up to date with the [OpenAI Blog](https://openai.com/blog/)

## Contributing

If there are examples or guides you'd like to see, feel free to suggest them on the [issues page](https://github.com/openai/openai-cookbook/issues).

The example uses [PCA](https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html) to reduce the dimensionality fo the embeddings from 1536 to 3. Then we can visualize the data points in a 3D plot. The small dataset `dbpedia_samples.jsonl` is curated by randomly sampling 200 samples from [DBpedia validation dataset](https://www.kaggle.com/danofer/dbpedia-classes?select=DBPEDIA_val.csv).

In [1]:

```
import pandas as pd
samples = pd.read_json("data/dbpedia_samples.jsonl", lines=True)
categories = sorted(samples["category"].unique())
print("Categories of DBpedia samples:", samples["category"].value_counts())
samples.head()

```

```
Categories of DBpedia samples: Artist                    21
Film                      19
Plant                     19
OfficeHolder              18
Company                   17
NaturalPlace              16
Athlete                   16
Village                   12
WrittenWork               11
Building                  11
Album                     11
Animal                    11
EducationalInstitution    10
MeanOfTransportation       8
Name: category, dtype: int64

```

Out[1]:

|  | text | category |
| --- | --- | --- |
| 0 | Morada Limited is a textile company based in ... | Company |
| 1 | The Armenian Mirror-Spectator is a newspaper ... | WrittenWork |
| 2 | Mt. Kinka (金華山 Kinka-zan) also known as Kinka... | NaturalPlace |
| 3 | Planning the Play of a Bridge Hand is a book ... | WrittenWork |
| 4 | Wang Yuanping (born 8 December 1976) is a ret... | Athlete |

In [2]:

```
from openai.embeddings_utils import get_embeddings
# NOTE: The following code will send a query of batch size 200 to /embeddings
matrix = get_embeddings(samples["text"].to_list(), engine="text-embedding-ada-002")

```

In [3]:

```
from sklearn.decomposition import PCA
pca = PCA(n_components=3)
vis_dims = pca.fit_transform(matrix)
samples["embed_vis"] = vis_dims.tolist()

```

In [4]:

```
%matplotlib widget
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure(figsize=(10, 5))
ax = fig.add_subplot(projection='3d')
cmap = plt.get_cmap("tab20")

# Plot each sample category individually such that we can set label name.
for i, cat in enumerate(categories):
    sub_matrix = np.array(samples[samples["category"] == cat]["embed_vis"].to_list())
    x=sub_matrix[:, 0]
    y=sub_matrix[:, 1]
    z=sub_matrix[:, 2]
    colors = [cmap(i/len(categories))] * len(sub_matrix)
    ax.scatter(x, y, zs=z, zdir='z', c=colors, label=cat)

ax.set_xlabel('x')
ax.set_ylabel('y')
ax.set_zlabel('z')
ax.legend(bbox_to_anchor=(1.1, 1))

```